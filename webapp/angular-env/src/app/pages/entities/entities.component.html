<table mat-table [dataSource]="dataSource" matSort matSortDisableClear="true" class="mat-elevation-z1">

  <!-- Title -->
  <ng-container matColumnDef="title">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
    <td mat-cell *matCellDef="let row">
      <div class="name-wrapper">
        <a [routerLink]="['/videos', row.id]">{{ row.title }}</a>
        <span class="name-detail">{{ row.fileName }}</span>
      </div>
    </td>
  </ng-container>

  <!-- Status -->
  <ng-container matColumnDef="status">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
    <td mat-cell *matCellDef="let row" [class.st-queued]="row.status==='queued'"
        [class.st-processing]="row.status==='processing'"
        [class.st-completed]="row.status==='completed'"
        [class.st-failed]="row.status==='failed'">
      <span class="dot"></span>{{ row.status }}
    </td>
  </ng-container>

  <!-- Duration -->
  <ng-container matColumnDef="duration">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Duration</th>
    <td mat-cell *matCellDef="let row" class="table-number">
      {{ toHms(row.durationSec) }}
    </td>
  </ng-container>

  <!-- FPS -->
  <ng-container matColumnDef="fps">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>FPS</th>
    <td mat-cell *matCellDef="let row" class="table-number">{{ row.fps }}</td>
  </ng-container>

  <!-- Resolution -->
  <ng-container matColumnDef="resolution">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Resolution</th>
    <td mat-cell *matCellDef="let row" class="table-number">{{ row.resolution }}</td>
  </ng-container>

  <!-- Size -->
  <ng-container matColumnDef="size">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Size</th>
    <td mat-cell *matCellDef="let row" class="table-number">{{ row.size }}</td>
  </ng-container>

  <!-- Faces -->
  <ng-container matColumnDef="faces">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Faces</th>
    <td mat-cell *matCellDef="let row" class="table-number">{{ row.faces }}</td>
  </ng-container>

  <!-- Dominant Emotion -->
  <ng-container matColumnDef="emotion">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Emotion</th>
    <td mat-cell *matCellDef="let row">
      <span class="pill">{{ row.dominantEmotion }}</span>
    </td>
  </ng-container>

  <!-- Confidence -->
  <ng-container matColumnDef="confidence">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Conf.</th>
    <td mat-cell *matCellDef="let row" class="table-number">
      {{ (row.confidence * 100) | number:'1.0-0' }}%
    </td>
  </ng-container>

  <!-- Uploaded By -->
  <ng-container matColumnDef="uploadedBy">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Uploader</th>
    <td mat-cell *matCellDef="let row">
      {{ row.uploadedBy.name }} ({{ row.uploadedBy.role }}, {{ row.uploadedBy.source }})
    </td>
  </ng-container>

  <!-- Created At -->
  <ng-container matColumnDef="createdAt">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Created</th>
    <td mat-cell *matCellDef="let row">{{ row.createdAt | date:'HH:mm:ss' }}</td>
  </ng-container>

  <!-- Actions -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Actions</th>
    <td mat-cell *matCellDef="let row" class="table-actions">
      <button mat-icon-button aria-label="View" title="View"
              (click)="$event.stopPropagation(); onView(row)">
        <mat-icon>visibility</mat-icon>
      </button>
      <button mat-icon-button aria-label="Delete" title="Delete"
              (click)="$event.stopPropagation(); onDelete(row)">
        <mat-icon>delete_outline</mat-icon>
      </button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>
